This problem asks for uniqueness, best strategy is to use restriction strategy, trying to encoding restricted lines with an index

Improved version should use a bitmap.
